---
title: "Demographics"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

```{r, include=FALSE}
library(ggplot2)
library(sjPlot)
library(kableExtra)
library(knitr)
library(dplyr)
library(tidyverse)

load("../data/bns_clean.Rdata")
bns <- out

opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE, cache=FALSE, fig.height=4, fig.width=6, fig.align = 'center')
# don't forget when done with sessino to turn CACHE = FALSE and clear knitr cache (last option under the knit button)

# Helper functions to display text answers without blank lines
display.text <- function(data, var){
  data %>% filter(!!as.symbol(var)!="") %>% select(!!as.symbol(var)) %>%
           kable(col.names=NULL) %>% 
           kable_styling(full_width = FALSE, 
           bootstrap_options =c("striped", "responsive", "hover", "condensed"))
}

sjPlot::set_theme(base = theme_bw())
```

# Gender `r emo::ji("star")`

### The US Census lists the following choices for sex: Male Female. Please choose the one that most closely fits your identity.

```{r}
plot_frq(bns$D2) + xlab("Sex")
```

70% of the respondents (n=105) are Female and 30% of the respondents (n=45) are Male.

### What was your sex assigned at birth?

```{r}
plot_frq(bns$D3, ylim = c(0,130)) + xlab("Sex")
```

70.7% of the respondents (n = 106) were Female at birth and 29.3% of the respondents (n = 44) were Male at birth.

### What is your gender identity?

```{r}
plot_frq(bns$D4) + xlab("Gender Identity")
```

69.3 % of the respondents identify as a Woman (n = 104), 28.7% identify as a Man (n = 43), and lastly 1.3% (n = 2) identify as Gender Queer or Gender-Nonconforming.

# Race / Ethnicity `r emo::ji("star")`

### How do you identify your race?

```{r}
plot_frq(bns$D5, wrap.labels = 10) + xlab("Race")
```

A majority of the respondents did not list their race (48.2% n = 68). 22.0% (n = 31) of the respondents identified as white, followed by 9.9% (n = 14) of the respondents identified as Black or African American. 9.9% (n = 14) of the respondents identified as Mixed race, and 7.8% (n = 11) identified as Asian. Lastly, 1.4% (n = 2) identified as American Indian or Alaska Native, and 0.7% (n = 1) identified as Native Hawaiian or other Pacific Islander.

### How do you identify your ethnicity?

```{r}
plot_frq(bns$D6) + xlab("Ethnicity")
```

74.7% (n = 109) of respondents identified as Hispanic or Latino and 25.3% (n = 37) identified as Non-Hispanic or Latino.

# Marital status

### What is your marital status? 

```{r}
plot_frq(bns$D7) + xlab("Marital Status")
```

A large proportion (88.5% n = 131) of the respondents reported that they are single and have never been married. 6.1% (n = 9) reporter they are married, 4.0% (n = 6) reported they are living with a partner, 0.7% (n = 1) reported they are separated, and lastly 0.7% (n = 1) reported they are widowed.

# Citizenship

### Are you a US citizen?

```{r}
plot_frq(bns$D8) + xlab("Citizenship Status")
```

92.6% (n = 137) of respondents reported that they are U.S. citizens and 7.4% (n = 11) reported they are not citizens.

### If not a U.S. citizen, are you a lawful permanent resident (i.e. have a “green card”)?

```{r}
plot_frq(bns$D8a, ylim = c(0,8)) + xlab("Permanent Resident")
```

Out of the participants that were not a U.S. citizen, 54.5% (n = 6) report they are not a permanent resident and 45.5% (n = 5) report they are a permanent resident.

# Dependents

### How many dependents receive more than 50% of their financial support from you?

```{r}
plot_frq(bns$D9_1) + xlab("Number of Dependents")
```

88.0% (n = 132) of participants report that they have 0 dependents who receive more than 50% of their financial support from them. 6.0% (n = 9) report that they have 1 dependent, 2.0% (n = 3) report they have 2 dependents, 1.3% (n = 2) report they have 3 dependents, 2.0% (n = 3) report they have 4 dependents, and lastly 0.7% (n = 1) report they have 5 dependents.

### What is/are the age(s) of your dependent(s)?

```{r}
#table(bns$age_dep_lt5)
```

### What is the highest level of education completedby parent 1:

```{r}
bns$D10 <- factor(bns$D10)
```

```{r}
levels(bns$D10)[levels(bns$D10) == "Certificate or technical achievement without Associateâ€™s degree"] <- "Certificate or technical achievement without Associate's degree"
```

```{r}
plot_frq(bns$D10, wrap.labels = 30) + theme(axis.text.x = element_text(angle = 70, hjust = 1)) + xlab("Education Level")
```

48.7% (n = 73) of the participants reported that their first parent's highest completed education level was less than high school. 23.3% (n = 35) reported that their first parent's highest completed education level was high school, 12.7% (n = 19) reported some college was achieved, 6.7% (n = 10) reported they did not know their first parent's highest level of education, and 4.0% (n = 6) reported their first parent's highest level of education was an assosciates degree. 2.7% (n = 4) reported their first parent's highest level of education was a bachelor's degree, 1.3% (n = 2) reported a master's degree was achieved, and lastly, 0.7% (n = 1) reported that their first parent's highest level of education acheieved was a certificate of technical achievement without an associate's degree.

### What is the highest level of education completedby parent 2:

```{r}
plot_frq(bns$D11) + theme(axis.text.x = element_text(angle = 70, hjust = 1)) + xlab("Education Level")
```

51.4% (n = 75) of participants reported that their second parent's highest level of education was less than high school, 25.3% (n = 37) reported that their second parent's highest level of education was high school, and 10.3% (n = 15) reported they did not know the education level of their second parent. 7.5% (n = 11) reported that some college was acheived, 3.4% (n = 5) reported that their second parent's highest education level was a bachelor's degree, 1.4% (n = 2) reported that their second parent's highest education level was a master's degree, and finally 0.7% (n = 1) reported that their second parent's highest education level was an associate's degree.

### What is your major at CSU, Chico?

```{r}
#table(bns$major)
```

### What is your major at CSU, Chico? (Text)

```{r}
#display.text(bns, "SD1_4_TEXT")
```

### What is your approximate overall Grade Point Average (GPA) for your current degree in progress? `r emo::ji("star")`

```{r}
plot_frq(bns$SD2) + xlab("GPA")
```

34.0% (n = 51) reported that their GPA is between 2.51 and 3.0, 32.0% (n = 48) reported that their GPA is between 3.01 and 3.5, and 20.0% (n = 30) reported that their GPA is between 2.01 and 2.5. 12.0% (n = 18) reported that their GPA is above 3.5 and lastly 2.0% (n = 3) reported that their GPA is between 1.51 and 2.0.

### How many units (rounded up) are you enrolled in for the current semester at CSU Chico?

```{r}
plot_frq(bns$SD3_1) + xlab("Units Enrolled")
```

### If currently enrolled at more than one college, how many units (rounded up) are you enrolled in for the current semester at other colleges (NOT CSU Chico)?

```{r}
plot_frq(bns$SD4_1, ylim = c(0,4)) + xlab("Units Enrolled Outside CSU Chico")
```

# Class Standing `r emo::ji("star")`

### Estimate your class level for the 2018-2019 academic school year by units completed (do not include units currently in progress this semester):

```{r}
plot_frq(bns$SD5) + theme(axis.text.x = element_text(angle = 70, hjust = 1)) + xlab("Class Level")
```

### What month and year did you first attend Chico State?

```{r}
#table(bns$matriculation_date)
```

### What month and year do you expect to graduatefrom Chico State to earn your current degree?

```{r}
#table(bns$exp_grad_date)
```


### Have you taken a semester off since you began attending Chico State? If so, how many? 

```{r}
plot_frq(bns$SD8_1) + xlab("Semester Taken Off")
```



